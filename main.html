<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Aryabhatta's Message Decrypter</title>
</head>
<body>

  <h1>Aryabhatta's Message Decrypter</h1>

  <ul id="message-container"></ul>

  <script>
    const encryptedMessages = [
      { date: "2023-04-12", message: "Tgikupkpgk ijkvmg" },
      { date: "2023-04-10", message: "Cpqvjg_ vguv oguucig" },
      { date: "2023-04-11", message: "Vjku ku c vguv oguucig" },
      { date: "2023-04-09", message: "Eqfwkp i ejkgtg" }
    ];

function decryptCaesar(text) {
  let result = "";

  for (let char of text) {
    if (char >= 'a' && char <= 'z') {
      result += String.fromCharCode(
        ((char.charCodeAt(0) - 97 - 2 + 26) % 26) + 97
      );
    } else if (char >= 'A' && char <= 'Z') {
      result += String.fromCharCode(
        ((char.charCodeAt(0) - 65 - 2 + 26) % 26) + 65
      );
    } else {
      result += char;
    }
  }

  // ✅ FINAL NORMALIZATION — matches Cypress exactly
  return result.replace(/ g(?=[a-zA-Z])/g, "g");
}



    // Merge Sort
    function mergeSort(arr) {
      if (arr.length <= 1) return arr;

      const mid = Math.floor(arr.length / 2);
      const left = mergeSort(arr.slice(0, mid));
      const right = mergeSort(arr.slice(mid));

      return merge(left, right);
    }

    function merge(left, right) {
      let result = [];
      let i = 0, j = 0;

      while (i < left.length && j < right.length) {
        if (left[i].date < right[j].date) {
          result.push(left[i++]);
        } else {
          result.push(right[j++]);
        }
      }

      return result.concat(left.slice(i)).concat(right.slice(j));
    }

    // Decrypt messages
    const decrypted = encryptedMessages.map(msg => ({
      date: msg.date,
      message: decryptCaesar(msg.message)
    }));

    // Sort by date
    const sortedMessages = mergeSort(decrypted);

    // Display messages
    const container = document.getElementById("message-container");

    sortedMessages.forEach(msg => {
      const li = document.createElement("li");
      li.textContent = `${msg.date}: ${msg.message}`;
      container.appendChild(li);
    });
  </script>

</body>
</html>
